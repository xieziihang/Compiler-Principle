## 修改

**解释部分**

1. 修改 Absyn.fs 文件中的抽象语法，添加表达式

![](https://s3.bmp.ovh/imgs/2022/06/02/5c2e5f1e2f13a3d5.png)



2. 在 Clex.fsl 文件中修改词法

![](https://s3.bmp.ovh/imgs/2022/06/02/3d6a6be4545e3d87.png)



3. 在 CPar.fsy 中增加 

![](https://s3.bmp.ovh/imgs/2022/06/02/bad00831effad589.png) 

![](https://s3.bmp.ovh/imgs/2022/06/02/9b6aa1ec7621a076.png)



4. 增加 Cpar.fsy 中非左值的情况 (`x ++ ` `x--` `++x` `--x`)

![](https://s3.bmp.ovh/imgs/2022/06/02/326b1a537c68ea83.png)

5. Interp.fs 中增加自增自减实现 （`x++`）

![](https://s3.bmp.ovh/imgs/2022/06/02/30addde1ebf5d7c3.png)



**编译部分：**

![](https://s3.bmp.ovh/imgs/2022/06/06/cef076069ec0abcf.png)

## 测试代码

```
void main()
{
  int i;
  print i;
  println;
  i++;
  print i;
  println;
  i--;
  print i;
  println;
  int j;
  j = 3;
  print j;
  ++j;
  println;
  print j;
  println;
  --j;
  print j;
}
```



## 运行结果

![](https://s3.bmp.ovh/imgs/2022/06/02/3a4ac759346906ef.png)

### AST:

![Wgl0t.png](https://s1.328888.xyz/2022/06/02/Wgl0t.png)



### 运行过程中堆栈追踪

```
[ ]{0:LDARGS}
[ ]{1:CALL 0 5}
[ 4 -999 ]{5:INCSP 1}
[ 4 -999 11867504 ]{7:GETBP}
[ 4 -999 11867504 2 ]{8:CSTI 0}
[ 4 -999 11867504 2 0 ]{10:ADD}
[ 4 -999 11867504 2 ]{11:CSTI 0}
[ 4 -999 11867504 2 0 ]{13:STI}
[ 4 -999 0 0 ]{14:INCSP -1}
[ 4 -999 0 ]{16:GETBP}
[ 4 -999 0 2 ]{17:CSTI 0}
[ 4 -999 0 2 0 ]{19:ADD}
[ 4 -999 0 2 ]{20:LDI}
[ 4 -999 0 0 ]{21:PRINTI}
0 [ 4 -999 0 0 ]{22:INCSP -1}
[ 4 -999 0 ]{24:CSTI 10}
[ 4 -999 0 10 ]{26:PRINTC}

[ 4 -999 0 10 ]{27:INCSP -1}
[ 4 -999 0 ]{29:GETBP}
[ 4 -999 0 2 ]{30:CSTI 0}
[ 4 -999 0 2 0 ]{32:ADD}
[ 4 -999 0 2 ]{33:DUP}
[ 4 -999 0 2 2 ]{34:LDI}
[ 4 -999 0 2 0 ]{35:CSTI 1}
[ 4 -999 0 2 0 1 ]{37:ADD}
[ 4 -999 0 2 1 ]{38:STI}
[ 4 -999 1 1 ]{39:INCSP -1}
[ 4 -999 1 ]{41:GETBP}
[ 4 -999 1 2 ]{42:CSTI 0}
[ 4 -999 1 2 0 ]{44:ADD}
[ 4 -999 1 2 ]{45:LDI}
[ 4 -999 1 1 ]{46:PRINTI}
1 [ 4 -999 1 1 ]{47:INCSP -1}
[ 4 -999 1 ]{49:CSTI 10}
[ 4 -999 1 10 ]{51:PRINTC}

[ 4 -999 1 10 ]{52:INCSP -1}
[ 4 -999 1 ]{54:GETBP}
[ 4 -999 1 2 ]{55:CSTI 0}
[ 4 -999 1 2 0 ]{57:ADD}
[ 4 -999 1 2 ]{58:DUP}
[ 4 -999 1 2 2 ]{59:LDI}
[ 4 -999 1 2 1 ]{60:CSTI 1}
[ 4 -999 1 2 1 1 ]{62:SUB}
[ 4 -999 1 2 0 ]{63:STI}
[ 4 -999 0 0 ]{64:INCSP -1}
[ 4 -999 0 ]{66:GETBP}
[ 4 -999 0 2 ]{67:CSTI 0}
[ 4 -999 0 2 0 ]{69:ADD}
[ 4 -999 0 2 ]{70:LDI}
[ 4 -999 0 0 ]{71:PRINTI}
0 [ 4 -999 0 0 ]{72:INCSP -1}
[ 4 -999 0 ]{74:CSTI 10}
[ 4 -999 0 10 ]{76:PRINTC}

[ 4 -999 0 10 ]{77:INCSP -1}
[ 4 -999 0 ]{79:INCSP 1}
[ 4 -999 0 10 ]{81:GETBP}
[ 4 -999 0 10 2 ]{82:CSTI 1}
[ 4 -999 0 10 2 1 ]{84:ADD}
[ 4 -999 0 10 3 ]{85:CSTI 3}
[ 4 -999 0 10 3 3 ]{87:STI}
[ 4 -999 0 3 3 ]{88:INCSP -1}
[ 4 -999 0 3 ]{90:GETBP}
[ 4 -999 0 3 2 ]{91:CSTI 1}
[ 4 -999 0 3 2 1 ]{93:ADD}
[ 4 -999 0 3 3 ]{94:LDI}
[ 4 -999 0 3 3 ]{95:PRINTI}
3 [ 4 -999 0 3 3 ]{96:INCSP -1}
[ 4 -999 0 3 ]{98:GETBP}
[ 4 -999 0 3 2 ]{99:CSTI 1}
[ 4 -999 0 3 2 1 ]{101:ADD}
[ 4 -999 0 3 3 ]{102:DUP}
[ 4 -999 0 3 3 3 ]{103:LDI}
[ 4 -999 0 3 3 3 ]{104:CSTI 1}
[ 4 -999 0 3 3 3 1 ]{106:ADD}
[ 4 -999 0 3 3 4 ]{107:STI}
[ 4 -999 0 4 10 ]{125:PRINTC}

[ 4 -999 0 4 10 ]{126:INCSP -1}
[ 4 -999 0 4 ]{128:GETBP}
[ 4 -999 0 4 2 ]{129:CSTI 1}
[ 4 -999 0 4 2 1 ]{131:ADD}
[ 4 -999 0 4 3 ]{132:DUP}
[ 4 -999 0 4 3 3 ]{133:LDI}
[ 4 -999 0 4 3 4 ]{134:CSTI 1}
[ 4 -999 0 4 3 4 1 ]{136:SUB}
[ 4 -999 0 4 3 3 ]{137:STI}
[ 4 -999 0 3 3 ]{138:INCSP -1}
[ 4 -999 0 3 ]{140:GETBP}
[ 4 -999 0 3 2 ]{141:CSTI 1}
[ 4 -999 0 3 2 1 ]{143:ADD}
[ 4 -999 0 3 3 ]{144:LDI}
[ 4 -999 0 3 3 ]{145:PRINTI}
3 [ 4 -999 0 3 3 ]{146:INCSP -1}
[ 4 -999 0 3 ]{148:INCSP -2}
[ 4 -999 ]{150:RET -1}
[ -999 ]{4:STOP}
```

